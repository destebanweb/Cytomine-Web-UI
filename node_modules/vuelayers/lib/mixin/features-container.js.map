{"version":3,"file":"features-container.js","sources":["src/mixin/features-container.js"],"sourcesContent":["import Feature from 'ol/Feature'\nimport Vue from 'vue'\nimport { initFeature } from '../ol-ext/feature'\nimport { instanceOf } from '../util/assert'\nimport { isPlainObject } from '../util/minilo'\nimport projTransforms from './proj-transforms'\n\nconst methods = {\n  /**\n   * @return {IndexedCollectionAdapter|SourceCollectionAdapter}\n   * @protected\n   */\n  getFeaturesTarget () {\n    throw new Error('Not implemented method')\n  },\n  /**\n   * @param {Array<(Feature|Vue|Object)>} features\n   * @return {void}\n   */\n  addFeatures (features) {\n    features.forEach(::this.addFeature)\n  },\n  /**\n   * @param {Feature|Vue|Object} feature\n   * @return {void}\n   */\n  addFeature (feature) {\n    if (feature instanceof Vue) {\n      feature = feature.$feature\n    } else if (isPlainObject(feature)) {\n      feature = this.readFeatureInDataProj(feature)\n    }\n    instanceOf(feature, Feature)\n\n    this.prepareFeature(feature)\n\n    if (!this.getFeaturesTarget().has(feature)) {\n      this.getFeaturesTarget().add(feature)\n    }\n  },\n  /**\n   * @param {Array<(Feature|Vue|Object)>} features\n   * @return {void}\n   */\n  removeFeatures (features) {\n    features.forEach(::this.removeFeature)\n  },\n  /**\n   * @param {Feature|Vue|Object} feature\n   * @return {void}\n   */\n  removeFeature (feature) {\n    if (feature instanceof Vue) {\n      feature = feature.$feature\n    } else if (isPlainObject(feature)) {\n      // feature = this._features[feature.id]\n      feature = this.getFeatureById(feature.id)\n    }\n    if (!feature) return\n\n    if (this.getFeaturesTarget().has(feature)) {\n      this.getFeaturesTarget().remove(feature)\n    }\n  },\n  /**\n   * @return {void}\n   */\n  clearFeatures () {\n    this.getFeaturesTarget().clear()\n  },\n  /**\n   * @param {string|number} id\n   * @return {Feature|undefined}\n   */\n  getFeatureById (id) {\n    return this.getFeaturesTarget().findByKey(id)\n  },\n  /**\n   * @return {Feature[]}\n   */\n  getFeatures () {\n    return this.getFeaturesTarget().elements\n  },\n  /**\n   * @returns {Object}\n   * @protected\n   */\n  getServices () {\n    const vm = this\n\n    return {\n      get featuresContainer () { return vm },\n    }\n  },\n  /**\n   * @param {Feature} feature\n   * @return {Feature}\n   * @protected\n   */\n  prepareFeature (feature) {\n    return initFeature(feature)\n  },\n}\n\nexport default {\n  mixins: [projTransforms],\n  methods,\n}\n"],"names":["methods","getFeaturesTarget","Error","addFeatures","features","forEach","addFeature","feature","Vue","$feature","isPlainObject","readFeatureInDataProj","instanceOf","Feature","prepareFeature","has","add","removeFeatures","removeFeature","getFeatureById","id","remove","clearFeatures","clear","findByKey","getFeatures","elements","getServices","vm","featuresContainer","initFeature","mixins","projTransforms"],"mappings":";;;;;;;;;;;;;;;;;AAOA,IAAMA,OAAO,GAAG;;;;;EAKdC,iBALc,+BAKO;UACb,IAAIC,KAAJ,CAAU,wBAAV,CAAN;GANY;;;;;;EAYdC,WAZc,uBAYDC,QAZC,EAYS;IACrBA,QAAQ,CAACC,OAAT,CAAmB,KAAKC,UAAxB,MAAmB,IAAnB;GAbY;;;;;;EAmBdA,UAnBc,sBAmBFC,OAnBE,EAmBO;QACfA,OAAO,YAAYC,GAAvB,EAA4B;MAC1BD,OAAO,GAAGA,OAAO,CAACE,QAAlB;KADF,MAEO,IAAIC,aAAa,CAACH,OAAD,CAAjB,EAA4B;MACjCA,OAAO,GAAG,KAAKI,qBAAL,CAA2BJ,OAA3B,CAAV;;;IAEFK,UAAU,CAACL,OAAD,EAAUM,OAAV,CAAV;SAEKC,cAAL,CAAoBP,OAApB;;QAEI,CAAC,KAAKN,iBAAL,GAAyBc,GAAzB,CAA6BR,OAA7B,CAAL,EAA4C;WACrCN,iBAAL,GAAyBe,GAAzB,CAA6BT,OAA7B;;GA9BU;;;;;;EAqCdU,cArCc,0BAqCEb,QArCF,EAqCY;IACxBA,QAAQ,CAACC,OAAT,CAAmB,KAAKa,aAAxB,MAAmB,IAAnB;GAtCY;;;;;;EA4CdA,aA5Cc,yBA4CCX,OA5CD,EA4CU;QAClBA,OAAO,YAAYC,GAAvB,EAA4B;MAC1BD,OAAO,GAAGA,OAAO,CAACE,QAAlB;KADF,MAEO,IAAIC,aAAa,CAACH,OAAD,CAAjB,EAA4B;;MAEjCA,OAAO,GAAG,KAAKY,cAAL,CAAoBZ,OAAO,CAACa,EAA5B,CAAV;;;QAEE,CAACb,OAAL,EAAc;;QAEV,KAAKN,iBAAL,GAAyBc,GAAzB,CAA6BR,OAA7B,CAAJ,EAA2C;WACpCN,iBAAL,GAAyBoB,MAAzB,CAAgCd,OAAhC;;GAtDU;;;;;EA4Dde,aA5Dc,2BA4DG;SACVrB,iBAAL,GAAyBsB,KAAzB;GA7DY;;;;;;EAmEdJ,cAnEc,0BAmEEC,EAnEF,EAmEM;WACX,KAAKnB,iBAAL,GAAyBuB,SAAzB,CAAmCJ,EAAnC,CAAP;GApEY;;;;;EAyEdK,WAzEc,yBAyEC;WACN,KAAKxB,iBAAL,GAAyByB,QAAhC;GA1EY;;;;;;EAgFdC,WAhFc,yBAgFC;QACPC,EAAE,GAAG,IAAX;WAEO;UACDC,iBAAJ,GAAyB;eAASD,EAAP;;;KAD7B;GAnFY;;;;;;;EA4Fdd,cA5Fc,0BA4FEP,OA5FF,EA4FW;WAChBuB,WAAW,CAACvB,OAAD,CAAlB;;CA7FJ;AAiGA,wBAAe;EACbwB,MAAM,EAAE,CAACC,cAAD,CADK;EAEbhC,OAAO,EAAPA;CAFF;;;;"}