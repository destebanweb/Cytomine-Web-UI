{"version":3,"file":"arcgis-source.js","sources":["src/mixin/arcgis-source.js"],"sourcesContent":["import { reduce } from '../util/minilo'\n\nconst cleanExtParams = params => reduce(params, (params, value, key) => {\n  let filterKeys = [\n    'FORMAT',\n    'F',\n    'LAYERS',\n    'LAYERDEFS',\n    'DYNAMICLAYERS',\n    'DPI',\n    'TRANSPARENT',\n    'TIME',\n    'LAYERTIMEOPTIONS',\n    'GDBVERSION',\n    'MAPSCALE',\n    'ROTATION',\n    'DATUMTRANSFORMATIONS',\n    'MAPRANGEVALUES',\n    'LAYERRANGEVALUES',\n    'LAYERPARAMETERVALUES',\n    'HISTORICMOMENT',\n  ]\n\n  key = key.toUpperCase()\n  if (filterKeys.includes(key)) {\n    return params\n  }\n\n  params[key] = value\n\n  return params\n}, {})\n\nconst serialize = value => {\n  if (value == null) return value\n\n  return typeof value === 'object' ? JSON.stringify(value) : value\n}\n\nconst props = {\n  /**\n   * Extra WMS request parameters\n   */\n  extParams: Object,\n  format: {\n    type: String,\n    default: 'PNG32',\n  },\n  layers: String,\n  layerDefs: [Object, String],\n  dynamicLayers: [Object, String],\n  dpi: Number,\n  transparent: {\n    type: Boolean,\n    default: true,\n  },\n  time: String,\n  layerTimeOptions: [Object, String],\n  gdbVersion: String,\n  mapScale: String,\n  rotation: Number,\n  datumTransformations: [Array, String],\n  mapRangeValues: [Array, String],\n  layerRangeValues: [Array, String],\n  layerParameterValues: [Array, String],\n  historicMoment: Number,\n}\n\nconst computed = {\n  cleanExtParams () {\n    return this.extParams ? cleanExtParams(this.extParams) : undefined\n  },\n  allParams () {\n    return {\n      ...this.cleanExtParams,\n      LAYERS: this.layers,\n      FORMAT: this.format,\n      LAYERDEFS: serialize(this.layerDefs),\n      DYNAMICLAYERS: serialize(this.dynamicLayers),\n      DPI: this.dpi,\n      TRANSPARENT: this.transparent,\n      TIME: serialize(this.time),\n      LAYERTIMEOPTIONS: serialize(this.layerTimeOptions),\n      GDBVERSION: this.gdbVersion,\n      MAPSCALE: this.mapScale,\n      ROTATION: this.rotation,\n      DATUMTRANSFORMATIONS: serialize(this.datumTransformations),\n      MAPRANGEVALUES: serialize(this.mapRangeValues),\n      LAYERRANGEVALUES: serialize(this.layerRangeValues),\n      LAYERPARAMETERVALUES: serialize(this.layerParameterValues),\n      HISTORICMOMENT: serialize(this.historicMoment),\n    }\n  },\n}\n\nconst methods = {}\n\nconst watch = {\n  layers (LAYERS) {\n    this.$source && this.$source.updateParams({ LAYERS })\n  },\n  format (FORMAT) {\n    this.$source && this.$source.updateParams({ FORMAT })\n  },\n  layerDefs (LAYERDEFS) {\n    this.$source && this.$source.updateParams({ LAYERDEFS: serialize(LAYERDEFS) })\n  },\n  dynamicLayers (DYNAMICLAYERS) {\n    this.$source && this.$source.updateParams({ DYNAMICLAYERS: serialize(DYNAMICLAYERS) })\n  },\n  dpi (DPI) {\n    this.$source && this.$source.updateParams({ DPI })\n  },\n  transparent (TRANSPARENT) {\n    this.$source && this.$source.updateParams({ TRANSPARENT })\n  },\n  time (TIME) {\n    this.$source && this.$source.updateParams({ TIME: serialize(TIME) })\n  },\n  layerTimeOptions (LAYERTIMEOPTIONS) {\n    this.$source && this.$source.updateParams({ LAYERTIMEOPTIONS: serialize(LAYERTIMEOPTIONS) })\n  },\n  gdbVersion (GDBVERSION) {\n    this.$source && this.$source.updateParams({ GDBVERSION })\n  },\n  mapScale (MAPSCALE) {\n    this.$source && this.$source.updateParams({ MAPSCALE })\n  },\n  rotation (ROTATION) {\n    this.$source && this.$source.updateParams({ ROTATION })\n  },\n  datumTransformations (DATUMTRANSFORMATIONS) {\n    this.$source && this.$source.updateParams({ DATUMTRANSFORMATIONS: serialize(DATUMTRANSFORMATIONS) })\n  },\n  mapRangeValues (MAPRANGEVALUES) {\n    this.$source && this.$source.updateParams({ MAPRANGEVALUES: serialize(MAPRANGEVALUES) })\n  },\n  layerRangeValues (LAYERRANGEVALUES) {\n    this.$source && this.$source.updateParams({ LAYERRANGEVALUES: serialize(LAYERRANGEVALUES) })\n  },\n  layerParameterValues (LAYERPARAMETERVALUES) {\n    this.$source && this.$source.updateParams({ LAYERPARAMETERVALUES: serialize(LAYERPARAMETERVALUES) })\n  },\n  historicMoment (HISTORICMOMENT) {\n    this.$source && this.$source.updateParams({ HISTORICMOMENT })\n  },\n  extParams (value) {\n    this.$source && this.$source.updateParams(value ? cleanExtParams(value) : undefined)\n  },\n}\n\nexport default {\n  props,\n  computed,\n  methods,\n  watch,\n}\n"],"names":["cleanExtParams","params","reduce","value","key","filterKeys","toUpperCase","includes","serialize","props","extParams","Object","format","type","String","default","layers","layerDefs","dynamicLayers","dpi","Number","transparent","Boolean","time","layerTimeOptions","gdbVersion","mapScale","rotation","datumTransformations","Array","mapRangeValues","layerRangeValues","layerParameterValues","historicMoment","computed","undefined","allParams","LAYERS","FORMAT","LAYERDEFS","DYNAMICLAYERS","DPI","TRANSPARENT","TIME","LAYERTIMEOPTIONS","GDBVERSION","MAPSCALE","ROTATION","DATUMTRANSFORMATIONS","MAPRANGEVALUES","LAYERRANGEVALUES","LAYERPARAMETERVALUES","HISTORICMOMENT","methods","watch","$source","updateParams"],"mappings":"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"}