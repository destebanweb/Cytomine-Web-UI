{"version":3,"file":"geojson.js","sources":["src/ol-ext/geojson.js"],"sourcesContent":["import Feature from 'ol/Feature'\nimport { get, isPlainObject } from '../util/minilo'\nimport { createGeoJsonFmt } from './format'\n\nconst geoJsonFmt = createGeoJsonFmt()\n\n/**\n * @param {Feature} feature\n * @param {ProjectionLike|undefined} [featureProjection]\n * @param {ProjectionLike|undefined} [dataProjection]\n * @return {Object}\n */\nexport function writeGeoJsonFeature (feature, featureProjection, dataProjection) {\n  const geoJsonFeature = geoJsonFmt.writeFeatureObject(feature, { featureProjection, dataProjection: dataProjection })\n\n  if (Array.isArray(get(geoJsonFeature, 'properties.features'))) {\n    geoJsonFeature.properties.features = geoJsonFeature.properties.features.map(feature => {\n      if (feature instanceof Feature) {\n        return writeGeoJsonFeature(feature, featureProjection, dataProjection)\n      }\n      return feature\n    })\n  }\n\n  return geoJsonFeature\n}\n\n/**\n * @param {Object} geoJsonFeature\n * @param {ProjectionLike|undefined} [featureProjection]\n * @param {ProjectionLike|undefined} [dataProjection]\n * @return {Feature}\n */\nexport function readGeoJsonFeature (geoJsonFeature, featureProjection, dataProjection) {\n  let feature = geoJsonFmt.readFeature(geoJsonFeature, { featureProjection, dataProjection: dataProjection })\n\n  if (Array.isArray(feature.get('features'))) {\n    feature.set('features', feature.get('features').map(feature => {\n      if (isPlainObject(feature)) {\n        return readGeoJsonFeature(feature, featureProjection, dataProjection)\n      }\n      return feature\n    }))\n  }\n\n  return feature\n}\n\n/**\n * @param {Geometry} geometry\n * @param {ProjectionLike|undefined} [geometryProjection]\n * @param {ProjectionLike|undefined} [dataProjection]\n * @return {Object}\n */\nexport function writeGeoJsonGeometry (geometry, geometryProjection, dataProjection) {\n  return geoJsonFmt.writeGeometryObject(geometry, {\n    featureProjection: geometryProjection,\n    dataProjection,\n  })\n}\n\n/**\n * @param {Object|Object} geoJsonGeometry\n * @param {ProjectionLike|undefined} [geometryProjection]\n * @param {ProjectionLike|undefined} [dataProjection]\n * @return {Geometry}\n */\nexport function readGeoJsonGeometry (geoJsonGeometry, geometryProjection, dataProjection) {\n  dataProjection = readProjection(geoJsonGeometry, dataProjection)\n\n  return geoJsonFmt.readGeometry(geoJsonGeometry, {\n    featureProjection: geometryProjection,\n    dataProjection,\n  })\n}\n\nexport function readProjection (geoJsonObj, defaultProjection) {\n  return geoJsonFmt.readProjection(geoJsonObj) || defaultProjection\n}\n"],"names":["geoJsonFmt","createGeoJsonFmt","writeGeoJsonFeature","feature","featureProjection","dataProjection","geoJsonFeature","writeFeatureObject","get","properties","features","map","Feature","readGeoJsonFeature","readFeature","set","isPlainObject","writeGeoJsonGeometry","geometry","geometryProjection","writeGeometryObject","readGeoJsonGeometry","geoJsonGeometry","readProjection","readGeometry","geoJsonObj","defaultProjection"],"mappings":";;;;;;;;;;;;;;;AAIA,IAAMA,UAAU,GAAGC,gBAAgB,EAAnC;;;;;;;;AAQA,AAAO,SAASC,mBAAT,CAA8BC,OAA9B,EAAuCC,iBAAvC,EAA0DC,cAA1D,EAA0E;MACzEC,cAAc,GAAGN,UAAU,CAACO,kBAAX,CAA8BJ,OAA9B,EAAuC;IAAEC,iBAAiB,EAAjBA,iBAAF;IAAqBC,cAAc,EAAEA;GAA5E,CAAvB;;MAEI,eAAcG,GAAG,CAACF,cAAD,EAAiB,qBAAjB,CAAjB,CAAJ,EAA+D;IAC7DA,cAAc,CAACG,UAAf,CAA0BC,QAA1B,GAAqCJ,cAAc,CAACG,UAAf,CAA0BC,QAA1B,CAAmCC,GAAnC,CAAuC,UAAAR,OAAO,EAAI;UACjFA,OAAO,YAAYS,OAAvB,EAAgC;eACvBV,mBAAmB,CAACC,OAAD,EAAUC,iBAAV,EAA6BC,cAA7B,CAA1B;;;aAEKF,OAAP;KAJmC,CAArC;;;SAQKG,cAAP;;;;;;;;;AASF,AAAO,SAASO,kBAAT,CAA6BP,cAA7B,EAA6CF,iBAA7C,EAAgEC,cAAhE,EAAgF;MACjFF,OAAO,GAAGH,UAAU,CAACc,WAAX,CAAuBR,cAAvB,EAAuC;IAAEF,iBAAiB,EAAjBA,iBAAF;IAAqBC,cAAc,EAAEA;GAA5E,CAAd;;MAEI,eAAcF,OAAO,CAACK,GAAR,CAAY,UAAZ,CAAd,CAAJ,EAA4C;IAC1CL,OAAO,CAACY,GAAR,CAAY,UAAZ,EAAwBZ,OAAO,CAACK,GAAR,CAAY,UAAZ,EAAwBG,GAAxB,CAA4B,UAAAR,OAAO,EAAI;UACzDa,aAAa,CAACb,OAAD,CAAjB,EAA4B;eACnBU,kBAAkB,CAACV,OAAD,EAAUC,iBAAV,EAA6BC,cAA7B,CAAzB;;;aAEKF,OAAP;KAJsB,CAAxB;;;SAQKA,OAAP;;;;;;;;;AASF,AAAO,SAASc,oBAAT,CAA+BC,QAA/B,EAAyCC,kBAAzC,EAA6Dd,cAA7D,EAA6E;SAC3EL,UAAU,CAACoB,mBAAX,CAA+BF,QAA/B,EAAyC;IAC9Cd,iBAAiB,EAAEe,kBAD2B;IAE9Cd,cAAc,EAAdA;GAFK,CAAP;;;;;;;;;AAYF,AAAO,SAASgB,mBAAT,CAA8BC,eAA9B,EAA+CH,kBAA/C,EAAmEd,cAAnE,EAAmF;EACxFA,cAAc,GAAGkB,cAAc,CAACD,eAAD,EAAkBjB,cAAlB,CAA/B;SAEOL,UAAU,CAACwB,YAAX,CAAwBF,eAAxB,EAAyC;IAC9ClB,iBAAiB,EAAEe,kBAD2B;IAE9Cd,cAAc,EAAdA;GAFK,CAAP;;AAMF,AAAO,SAASkB,cAAT,CAAyBE,UAAzB,EAAqCC,iBAArC,EAAwD;SACtD1B,UAAU,CAACuB,cAAX,CAA0BE,UAA1B,KAAyCC,iBAAhD;;;;;"}