{"version":3,"file":"from-ol-change-event.js","sources":["src/rx-ext/from-ol-change-event.js"],"sourcesContent":["import { merge as mergeObs } from 'rxjs/observable'\nimport { distinctUntilChanged, map as mapObs, throttleTime } from 'rxjs/operators'\nimport { isEqual, isFunction } from '../util/minilo'\nimport fromOlEvent from './from-ol-event'\n\n/**\n * Creates Observable from OpenLayers change:* event\n * @param {ol.Object} target\n * @param {string|string[]} [prop]\n * @param {boolean|function(a, b):boolean|undefined} [distinct] Distinct values by isEqual fn or by custom comparator\n * @param {number|undefined} [throttle] Throttle values by passed amount of ms.\n * @param {function(target: ol.Object, prop: string):*|undefined} [selector] Custom selector\n * @return {Observable<{prop: string, value: *}>}\n */\nexport default function fromOlChangeEvent (target, prop, distinct, throttle, selector) {\n  if (Array.isArray(prop)) {\n    return mergeObs(...prop.map(p => fromOlChangeEvent(target, p)))\n  }\n\n  selector = selector || ((target, prop) => target.get(prop))\n  let event = `change:${prop}`\n  let observable = fromOlEvent(target, event, () => selector(target, prop))\n  let operations = []\n\n  if (throttle != null) {\n    operations.push(throttleTime(throttle))\n  }\n  if (distinct) {\n    isFunction(distinct) || (distinct = isEqual)\n    operations.push(distinctUntilChanged(distinct))\n  }\n\n  operations.push(mapObs(value => ({ prop, value })))\n\n  return observable.pipe(...operations)\n}\n"],"names":["fromOlChangeEvent","target","prop","distinct","throttle","selector","mergeObs","map","p","get","event","observable","fromOlEvent","operations","push","throttleTime","isFunction","isEqual","distinctUntilChanged","mapObs","value","pipe"],"mappings":";;;;;;;;;;;;;;;;;;;AAKA;;;;;;;;;;AASA,AAAe,SAASA,iBAAT,CAA4BC,MAA5B,EAAoCC,IAApC,EAA0CC,QAA1C,EAAoDC,QAApD,EAA8DC,QAA9D,EAAwE;MACjF,eAAcH,IAAd,CAAJ,EAAyB;WAChBI,KAAQ,MAAR,4BAAYJ,IAAI,CAACK,GAAL,CAAS,UAAAC,CAAC;aAAIR,iBAAiB,CAACC,MAAD,EAASO,CAAT,CAArB;KAAV,CAAZ,EAAP;;;EAGFH,QAAQ,GAAGA,QAAQ,IAAK,UAACJ,MAAD,EAASC,IAAT;WAAkBD,MAAM,CAACQ,GAAP,CAAWP,IAAX,CAAlB;GAAxB;;MACIQ,KAAK,oBAAaR,IAAb,CAAT;MACIS,UAAU,GAAGC,WAAW,CAACX,MAAD,EAASS,KAAT,EAAgB;WAAML,QAAQ,CAACJ,MAAD,EAASC,IAAT,CAAd;GAAhB,CAA5B;MACIW,UAAU,GAAG,EAAjB;;MAEIT,QAAQ,IAAI,IAAhB,EAAsB;IACpBS,UAAU,CAACC,IAAX,CAAgBC,YAAY,CAACX,QAAD,CAA5B;;;MAEED,QAAJ,EAAc;IACZa,UAAU,CAACb,QAAD,CAAV,KAAyBA,QAAQ,GAAGc,OAApC;IACAJ,UAAU,CAACC,IAAX,CAAgBI,oBAAoB,CAACf,QAAD,CAApC;;;EAGFU,UAAU,CAACC,IAAX,CAAgBK,GAAM,CAAC,UAAAC,KAAK;WAAK;MAAElB,IAAI,EAAJA,IAAF;MAAQkB,KAAK,EAALA;KAAb;GAAN,CAAtB;SAEOT,UAAU,CAACU,IAAX,OAAAV,UAAU,EAASE,UAAT,CAAjB;;;;;"}