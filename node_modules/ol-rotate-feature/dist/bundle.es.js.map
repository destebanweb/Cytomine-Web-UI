{"version":3,"file":"bundle.es.js","sources":["../src/util.js","../src/event.js","../src/shim.js","../src/interaction.js","../src/index.js"],"sourcesContent":["/**\n * This file is part of ol-rotate-feature package.\n * @module ol-rotate-feature\n * @license MIT\n * @author Vladimir Vershinin\n */\n\n/**\n * @param {boolean} condition\n * @param {string} message\n * @throws Error\n */\nexport function assert (condition, message = '') {\n  message = [ 'Assertion failed', message ].join(': ')\n\n  if (!condition) {\n    throw new Error(message)\n  }\n}\n\n/**\n * @param {*} arg\n * @returns {*}\n */\nexport function identity (arg) {\n  return arg\n}\n\n/**\n * @param {...*} args\n * @return {*}\n */\nexport function coalesce (...args) {\n  return args.filter(value => value != null).shift()\n}\n\nconst counters = {}\n/**\n * @param {string} [prefix]\n * @return {number}\n */\nexport function uniqId (prefix = '') {\n  const ns = prefix || 'default'\n  counters[ ns ] = counters[ ns ] == null ? 0 : counters[ ns ]\n\n  return String(prefix) + (++counters[ ns ])\n}\n\nexport function includes (arr, value) {\n  return arr.indexOf(value) !== -1\n}\n\nexport function isArray (val) {\n  return val::Object.prototype.toString() === '[object Array]'\n}\n","/**\n * This file is part of ol-rotate-feature package.\n * @module ol-rotate-feature\n * @license MIT\n * @author Vladimir Vershinin\n */\n/**\n * @enum {string}\n */\nexport const RotateFeatureEventType = {\n  /**\n   * Triggered upon feature rotate start.\n   * @event RotateFeatureEvent#rotatestart\n   */\n  START: 'rotatestart',\n  /**\n   * Triggered upon feature rotation.\n   * @event RotateFeatureEvent#rotating\n   */\n  ROTATING: 'rotating',\n  /**\n   * Triggered upon feature rotation end.\n   * @event RotateFeatureEvent#rotateend\n   */\n  END: 'rotateend'\n}\n\n/**\n * Events emitted by RotateFeatureInteraction instances are instances of this type.\n *\n * @class\n * @author Vladimir Vershinin\n */\nexport default class RotateFeatureEvent {\n  /**\n   * @param {string} type Type.\n   * @param {ol.Collection<ol.Feature>} features Rotated features.\n   * @param {number} angle Angle in radians.\n   * @param {ol.Coordinate} anchor Anchor position.\n   */\n  constructor (type, features, angle, anchor) {\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.propagationStopped_ = false\n\n    /**\n     * The event type.\n     * @type {string}\n     * @private\n     */\n    this.type_ = type\n\n    /**\n     * The features being rotated.\n     * @type {ol.Collection<ol.Feature>}\n     * @private\n     */\n    this.features_ = features\n    /**\n     * Current angle in radians.\n     * @type {number}\n     * @private\n     */\n    this.angle_ = angle\n    /**\n     * Current rotation anchor.\n     * @type {ol.Coordinate}\n     * @private\n     */\n    this.anchor_ = anchor\n  }\n\n  /**\n   * @type {boolean}\n   */\n  get propagationStopped () {\n    return this.propagationStopped_\n  }\n\n  /**\n   * @type {RotateFeatureEventType}\n   */\n  get type () {\n    return this.type_\n  }\n\n  /**\n   * @type {ol.Collection<ol.Feature>}\n   */\n  get features () {\n    return this.features_\n  }\n\n  /**\n   * @type {number}\n   */\n  get angle () {\n    return this.angle_\n  }\n\n  /**\n   * @type {ol.Coordinate}\n   */\n  get anchor () {\n    return this.anchor_\n  }\n\n  /**\n   * Prevent event propagation.\n   */\n  preventDefault () {\n    this.propagationStopped_ = true\n  }\n\n  /**\n   * Stop event propagation.\n   */\n  stopPropagation () {\n    this.propagationStopped_ = true\n  }\n}\n","const ua = typeof navigator !== 'undefined' ? navigator.userAgent.toLowerCase() : ''\n\nexport const MAC = ua.indexOf('macintosh') !== -1\n\nexport const WEBKIT = ua.indexOf('webkit') !== -1 && ua.indexOf('edge') == -1\n\nexport const mouseActionButton = function (mapBrowserEvent) {\n  const originalEvent = /** @type {MouseEvent} */ (mapBrowserEvent.originalEvent)\n  return originalEvent.button == 0 && !(WEBKIT && MAC && originalEvent.ctrlKey)\n}\n","/**\n * This file is part of ol-rotate-feature package.\n * @module ol-rotate-feature\n * @license MIT\n * @author Vladimir Vershinin\n */\n/**\n * Rotate interaction class.\n * Adds controls to rotate vector features.\n * Writes out total angle in radians (positive is counter-clockwise) to property for each feature.\n */\nimport PointerInteraction from 'ol/interaction/Pointer'\nimport Collection from 'ol/Collection'\nimport VectorLayer from 'ol/layer/Vector'\nimport VectorSource from 'ol/source/Vector'\nimport Feature from 'ol/Feature'\nimport Point from 'ol/geom/Point'\nimport Polygon from 'ol/geom/Polygon'\nimport GeometryCollection from 'ol/geom/GeometryCollection'\nimport Style from 'ol/style/Style'\nimport RegularShape from 'ol/style/RegularShape'\nimport Stroke from 'ol/style/Stroke'\nimport Fill from 'ol/style/Fill'\nimport Text from 'ol/style/Text'\nimport {getCenter as getExtentCenter} from 'ol/extent'\nimport { always, mouseOnly } from 'ol/events/condition';\nimport { assert, identity, includes, isArray } from './util'\nimport RotateFeatureEvent, { RotateFeatureEventType } from './event'\nimport { mouseActionButton } from './shim'\n\nconst ANCHOR_KEY = 'rotate-anchor'\nconst ARROW_KEY = 'rotate-arrow'\n\nconst ANGLE_PROP = 'angle'\nconst ANCHOR_PROP = 'anchor'\n\n/**\n * @todo todo добавить опцию condition - для возможности переопределения клавиш\n */\nexport default class RotateFeatureInteraction extends PointerInteraction {\n  /**\n   * @param {InteractionOptions} options\n   */\n  constructor (options = {}) {\n    super({\n      // handleEvent: handleEvent,\n      handleDownEvent,\n      handleUpEvent,\n      handleDragEvent,\n      handleMoveEvent\n    })\n    /**\n     * @type {string}\n     * @private\n     */\n    this.previousCursor_ = undefined\n    /**\n     * @type {Feature}\n     * @private\n     */\n    this.anchorFeature_ = undefined\n    /**\n     * @type {Feature}\n     * @private\n     */\n    this.arrowFeature_ = undefined\n    /**\n     * @type {Coordinate}\n     * @private\n     */\n    this.lastCoordinate_ = undefined\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.anchorMoving_ = false\n    /**\n     * @type {Vector}\n     * @private\n     */\n    this.overlay_ = new VectorLayer({\n      style: options.style || getDefaultStyle(),\n      source: new VectorSource({\n        features: new Collection()\n      })\n    })\n    /**\n     * @private\n     * @type {module:ol/events/condition~Condition}\n     */\n    this.condition_ = options.condition ? options.condition : always;\n    /**\n     * @type {Collection<Feature>}\n     * @private\n     */\n    this.features_ = undefined\n    if (options.features) {\n      if (isArray(options.features)) {\n        this.features_ = new Collection(options.features)\n      } else if (options.features instanceof Collection) {\n        this.features_ = options.features\n      } else {\n        throw new Error('Features option should be an array or collection of features, ' +\n                        'got ' + (typeof options.features))\n      }\n    } else {\n      this.features_ = new Collection()\n    }\n\n    /**\n     * @type {boolean}\n     * @public\n     */\n    this.allowAnchorMovement = options.allowAnchorMovement === undefined ? true : options.allowAnchorMovement;\n\n    this.setAnchor(options.anchor || getFeaturesCentroid(this.features_))\n    this.setAngle(options.angle || 0)\n\n    this.features_.on('add', ::this.onFeatureAdd_)\n    this.features_.on('remove', ::this.onFeatureRemove_)\n    this.on('change:' + ANGLE_PROP, ::this.onAngleChange_)\n    this.on('change:' + ANCHOR_PROP, ::this.onAnchorChange_)\n\n    this.createOrUpdateAnchorFeature_()\n    this.createOrUpdateArrowFeature_()\n  }\n\n  /**\n   * @type {Collection<Feature>}\n   */\n  get features () {\n    return this.features_\n  }\n\n  /**\n   * @type {number}\n   */\n  get angle () {\n    return this.getAngle()\n  }\n\n  /**\n   * @param {number} angle\n   */\n  set angle (angle) {\n    this.setAngle(angle)\n  }\n\n  /**\n   * @type {Coordinate|number[]|undefined}\n   */\n  get anchor () {\n    return this.getAnchor()\n  }\n\n  /**\n   * @param {Coordinate|undefined} anchor\n   */\n  set anchor (anchor) {\n    this.setAnchor(anchor)\n  }\n\n  /**\n   * @param {PluggableMap} map\n   */\n  set map (map) {\n    this.setMap(map)\n  }\n\n  /**\n   * @type {PluggableMap}\n   */\n  get map() {\n    return this.getMap()\n  }\n\n  /**\n   * @param {boolean} active\n   */\n  set active (active) {\n    this.setActive(active)\n  }\n\n  /**\n   * @type {boolean}\n   */\n  get active () {\n    return this.getActive()\n  }\n\n  /**\n   * @param {ol.Map} map\n   */\n  setMap (map) {\n    this.overlay_.setMap(map)\n    super.setMap(map)\n  }\n\n  /**\n   * @param {boolean} active\n   */\n  setActive (active) {\n    if (this.overlay_) {\n      this.overlay_.setMap(active ? this.map : undefined)\n    }\n\n    super.setActive(active)\n  }\n\n  /**\n   * Set current angle of interaction features.\n   *\n   * @param {number} angle\n   */\n  setAngle (angle) {\n    assert(!isNaN(parseFloat(angle)), 'Numeric value passed')\n\n    this.set(ANGLE_PROP, parseFloat(angle))\n  }\n\n  /**\n   * Returns current angle of interaction features.\n   *\n   * @return {number}\n   */\n  getAngle () {\n    return this.get(ANGLE_PROP)\n  }\n\n  /**\n   * Set current anchor position.\n   *\n   * @param {Coordinate | undefined} anchor\n   */\n  setAnchor (anchor) {\n    assert(anchor == null || isArray(anchor) && anchor.length === 2, 'Array of two elements passed')\n\n    this.set(ANCHOR_PROP, anchor != null ? anchor.map(parseFloat) : getFeaturesCentroid(this.features_))\n  }\n\n  /**\n   * Returns current anchor position.\n   *\n   * @return {Coordinate | undefined}\n   */\n  getAnchor () {\n    return this.get(ANCHOR_PROP)\n  }\n\n  /**\n   * @private\n   */\n  createOrUpdateAnchorFeature_ () {\n    const angle = this.getAngle()\n    const anchor = this.getAnchor()\n\n    if (!anchor) return\n\n    if (this.anchorFeature_) {\n      this.anchorFeature_.getGeometry().setCoordinates(anchor)\n      this.anchorFeature_.set(ANGLE_PROP, angle)\n    } else {\n      this.anchorFeature_ = new Feature({\n        geometry: new Point(anchor),\n        [ ANGLE_PROP ]: angle,\n        [ ANCHOR_KEY ]: true\n      })\n      this.overlay_.getSource().addFeature(this.anchorFeature_)\n    }\n  }\n\n  /**\n   * @private\n   */\n  createOrUpdateArrowFeature_ () {\n    const angle = this.getAngle()\n    const anchor = this.getAnchor()\n\n    if (!anchor) return\n\n    if (this.arrowFeature_) {\n      this.arrowFeature_.getGeometry().setCoordinates(anchor)\n      this.arrowFeature_.set(ANGLE_PROP, angle)\n    } else {\n      this.arrowFeature_ = new Feature({\n        geometry: new Point(anchor),\n        [ ANGLE_PROP ]: angle,\n        [ ARROW_KEY ]: true\n      })\n      this.overlay_.getSource().addFeature(this.arrowFeature_)\n    }\n  }\n\n  /**\n   * @private\n   */\n  resetAngleAndAnchor_() {\n    this.resetAngle_();\n    this.resetAnchor_();\n  }\n\n  /**\n   * @private\n   */\n  resetAngle_() {\n    this.set(ANGLE_PROP, 0, true);\n    this.arrowFeature_ && this.arrowFeature_.set(ANGLE_PROP, this.getAngle());\n    this.anchorFeature_ && this.anchorFeature_.set(ANGLE_PROP, this.getAngle());\n  }\n\n  /**\n   * @private\n   */\n  resetAnchor_() {\n    this.set(ANCHOR_PROP, getFeaturesCentroid(this.features_), true);\n\n    if (this.getAnchor()) {\n      this.arrowFeature_ && this.arrowFeature_.getGeometry().setCoordinates(this.getAnchor());\n      this.anchorFeature_ && this.anchorFeature_.getGeometry().setCoordinates(this.getAnchor());\n    }\n  }\n\n  /**\n   * @private\n   */\n  onFeatureAdd_ () {\n    this.resetAngleAndAnchor_()\n    this.createOrUpdateAnchorFeature_()\n    this.createOrUpdateArrowFeature_()\n  }\n\n  /**\n   * @private\n   */\n  onFeatureRemove_ () {\n    this.resetAngleAndAnchor_()\n\n    if (this.features_.getLength()) {\n      this.createOrUpdateAnchorFeature_()\n      this.createOrUpdateArrowFeature_()\n    } else {\n      this.overlay_.getSource().clear()\n      this.anchorFeature_ = this.arrowFeature_ = undefined\n    }\n  }\n\n  /**\n   * @private\n   */\n  onAngleChange_({ oldValue }) {\n    this.features_.forEach(feature => feature.getGeometry().rotate(this.getAngle() - oldValue, this.getAnchor()))\n    this.arrowFeature_ && this.arrowFeature_.set(ANGLE_PROP, this.getAngle())\n    this.anchorFeature_ && this.anchorFeature_.set(ANGLE_PROP, this.getAngle())\n  }\n\n  /**\n   * @private\n   */\n  onAnchorChange_() {\n    const anchor = this.getAnchor()\n\n    if (anchor) {\n      this.anchorFeature_ && this.anchorFeature_.getGeometry().setCoordinates(anchor)\n      this.arrowFeature_ && this.arrowFeature_.getGeometry().setCoordinates(anchor)\n    }\n  }\n\n  /**\n   * @param {Collection<Feature>} features\n   * @private\n   */\n  dispatchRotateStartEvent_ (features) {\n    this.dispatchEvent(\n      new RotateFeatureEvent(\n        RotateFeatureEventType.START,\n        features,\n        this.getAngle(),\n        this.getAnchor()\n      )\n    )\n  }\n\n  /**\n   * @param {Collection<Feature>} features\n   * @private\n   */\n  dispatchRotatingEvent_ (features) {\n    this.dispatchEvent(\n      new RotateFeatureEvent(\n        RotateFeatureEventType.ROTATING,\n        features,\n        this.getAngle(),\n        this.getAnchor()\n      )\n    )\n  }\n\n  /**\n   * @param {Collection<Feature>} features\n   * @private\n   */\n  dispatchRotateEndEvent_ (features) {\n    this.dispatchEvent(\n      new RotateFeatureEvent(\n        RotateFeatureEventType.END,\n        features,\n        this.getAngle(),\n        this.getAnchor()\n      )\n    )\n  }\n}\n\n/**\n * @param {MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {RotateFeatureInteraction}\n * @private\n */\n// function handleEvent (evt) {\n//   // disable selection of inner features\n//   const foundFeature = evt.map.forEachFeatureAtPixel(evt.pixel, identity)\n//   if (\n//     includes([ 'click', 'singleclick', 'dblclick' ], evt.type) &&\n//     includes([ this.anchorFeature_, this.arrowFeature_ ], foundFeature)\n//   ) {\n//     return false\n//   }\n//\n//   return this::baseHandleEvent(evt)\n// }\n\n/**\n * @param {MapBrowserEvent} evt Event.\n * @return {boolean}\n * @this {RotateFeatureInteraction}\n * @private\n */\nfunction handleDownEvent (evt) {\n  if (!mouseOnly(evt)) {\n    return false;\n  }\n\n  if (mouseActionButton(evt) && this.condition_(evt)) {\n    // disable selection of inner features\n    const foundFeature = evt.map.forEachFeatureAtPixel(evt.pixel, identity)\n    if (\n      includes([ 'click', 'singleclick', 'dblclick' ], evt.type) &&\n      includes([ this.anchorFeature_, this.arrowFeature_ ], foundFeature)\n    ) {\n      return false\n    }\n    // handle click & drag on features for rotation\n    if (\n      foundFeature && !this.lastCoordinate_ &&\n      (\n        includes(this.features_.getArray(), foundFeature) ||\n        foundFeature === this.arrowFeature_\n      )\n    ) {\n      this.lastCoordinate_ = evt.coordinate\n\n      this::handleMoveEvent(evt)\n      this.dispatchRotateStartEvent_(this.features_)\n\n      return true\n    }\n    // handle click & drag on rotation anchor feature\n    else if (foundFeature && foundFeature === this.anchorFeature_ && this.allowAnchorMovement) {\n      this.anchorMoving_ = true\n      this::handleMoveEvent(evt)\n\n      return true\n    }\n  }\n  return false\n}\n\n/**\n * @param {MapBrowserEvent} evt Event.\n * @return {boolean}\n * @this {RotateFeatureInteraction}\n * @private\n */\nfunction handleUpEvent (evt) {\n  // stop drag sequence of features\n  if (this.lastCoordinate_) {\n    this.lastCoordinate_ = undefined\n\n    this::handleMoveEvent(evt)\n    this.dispatchRotateEndEvent_(this.features_)\n\n    return true\n  }\n  // stop drag sequence of the anchors\n  else if (this.anchorMoving_) {\n    this.anchorMoving_ = false\n    this::handleMoveEvent(evt)\n\n    return true\n  }\n\n  return false\n}\n\n/**\n * @param {MapBrowserEvent} evt Event.\n * @return {boolean}\n * @this {RotateFeatureInteraction}\n * @private\n */\nfunction handleDragEvent ({ coordinate }) {\n  const anchorCoordinate = this.anchorFeature_.getGeometry().getCoordinates()\n\n  // handle drag of features by angle\n  if (this.lastCoordinate_) {\n    // calculate vectors of last and current pointer positions\n    const lastVector = [\n      this.lastCoordinate_[ 0 ] - anchorCoordinate[ 0 ],\n      this.lastCoordinate_[ 1 ] - anchorCoordinate[ 1 ]\n    ]\n    const newVector = [\n      coordinate[ 0 ] - anchorCoordinate[ 0 ],\n      coordinate[ 1 ] - anchorCoordinate[ 1 ]\n    ]\n\n    // calculate angle between last and current vectors (positive angle counter-clockwise)\n    let angle = Math.atan2(\n      lastVector[ 0 ] * newVector[ 1 ] - newVector[ 0 ] * lastVector[ 1 ],\n      lastVector[ 0 ] * newVector[ 0 ] + lastVector[ 1 ] * newVector[ 1 ]\n    )\n\n    this.setAngle(this.getAngle() + angle)\n    this.dispatchRotatingEvent_(this.features_)\n\n    this.lastCoordinate_ = coordinate\n  }\n  // handle drag of the anchor\n  else if (this.anchorMoving_) {\n    this.setAnchor(coordinate)\n  }\n}\n\n/**\n * @param {MapBrowserEvent} evt Event.\n * @return {boolean}\n * @this {RotateFeatureInteraction}\n * @private\n */\nfunction handleMoveEvent ({ map, pixel }) {\n  const elem = map.getTargetElement()\n  const foundFeature = map.forEachFeatureAtPixel(pixel, identity)\n\n  const setCursor = (cursor, vendor = false) => {\n    if (vendor) {\n      elem.style.cursor = '-webkit-' + cursor\n      elem.style.cursor = '-moz-' + cursor\n    }\n\n    elem.style.cursor = cursor\n  }\n\n  if (this.lastCoordinate_) {\n    this.previousCursor_ = elem.style.cursor\n    setCursor('grabbing', true)\n  } else if (\n    foundFeature &&\n    (\n      includes(this.features_.getArray(), foundFeature) ||\n      foundFeature === this.arrowFeature_\n    )\n  ) {\n    this.previousCursor_ = elem.style.cursor\n    setCursor('grab', true)\n  } else if (( foundFeature && foundFeature === this.anchorFeature_ && this.allowAnchorMovement) || this.anchorMoving_) {\n    this.previousCursor_ = elem.style.cursor\n    setCursor('crosshair')\n  } else {\n    setCursor(this.previousCursor_ || '')\n    this.previousCursor_ = undefined\n  }\n}\n\n/**\n * @returns {StyleFunction}\n * @private\n */\nfunction getDefaultStyle () {\n  const white = [ 255, 255, 255, 0.8 ]\n  const blue = [ 0, 153, 255, 0.8 ]\n  const transparent = [ 255, 255, 255, 0.01 ]\n  const width = 2\n\n  const styles = {\n    [ ANCHOR_KEY ]: [\n      new Style({\n        image: new RegularShape({\n          fill: new Fill({\n            color: [ 0, 153, 255, 0.8 ]\n          }),\n          stroke: new Stroke({\n            color: blue,\n            width: 1\n          }),\n          radius: 4,\n          points: 6\n        }),\n        zIndex: Infinity\n      })\n    ],\n    [ ARROW_KEY ]: [\n      new Style({\n        fill: new Fill({\n          color: transparent\n        }),\n        stroke: new Stroke({\n          color: white,\n          width: width + 2\n        }),\n        text: new Text({\n          font: '12px sans-serif',\n          offsetX: 20,\n          offsetY: -20,\n          fill: new Fill({\n            color: 'blue'\n          }),\n          stroke: new Stroke({\n            color: white,\n            width: width + 1\n          })\n        }),\n        zIndex: Infinity\n      }),\n      new Style({\n        fill: new Fill({\n          color: transparent\n        }),\n        stroke: new Stroke({\n          color: blue,\n          width\n        }),\n        zIndex: Infinity\n      })\n    ]\n  }\n\n  return function (feature, resolution) {\n    let style\n    const angle = feature.get(ANGLE_PROP) || 0\n\n    switch (true) {\n      case feature.get(ANCHOR_KEY):\n        style = styles[ ANCHOR_KEY ]\n        style[ 0 ].getImage().setRotation(-angle)\n\n        return style\n      case feature.get(ARROW_KEY):\n        style = styles[ ARROW_KEY ]\n\n        const coordinates = feature.getGeometry().getCoordinates()\n        // generate arrow polygon\n        const geom = new Polygon([\n          [\n            [ coordinates[ 0 ], coordinates[ 1 ] - 6 * resolution ],\n            [ coordinates[ 0 ] + 8 * resolution, coordinates[ 1 ] - 12 * resolution ],\n            [ coordinates[ 0 ], coordinates[ 1 ] + 30 * resolution ],\n            [ coordinates[ 0 ] - 8 * resolution, coordinates[ 1 ] - 12 * resolution ],\n            [ coordinates[ 0 ], coordinates[ 1 ] - 6 * resolution ],\n          ]\n        ])\n\n        // and rotate it according to current angle\n        geom.rotate(angle, coordinates)\n        style[ 0 ].setGeometry(geom)\n        style[ 1 ].setGeometry(geom)\n        style[ 0 ].getText().setText(Math.round(-angle * 180 / Math.PI) + '°')\n\n        return style\n    }\n  }\n}\n\n/**\n * @param {Collection<Feature>|Array<Feature>} features\n * @returns {Extent | number[] | undefined}\n * @private\n */\nfunction getFeaturesExtent (features) {\n  features = features instanceof Collection ? features.getArray() : features\n  if (!features.length) return\n\n  return new GeometryCollection(features.map(feature => feature.getGeometry())).getExtent()\n}\n\n/**\n * @param {Collection<ol.Feature> | Array<Feature>} features\n * @return {Coordinate | number[] | undefined}\n */\nfunction getFeaturesCentroid (features) {\n  features = features instanceof Collection ? features.getArray() : features\n  if (!features.length) return\n\n  return getExtentCenter(getFeaturesExtent(features))\n}\n","/**\n * This file is part of ol-rotate-feature package.\n * @module ol-rotate-feature\n * @license MIT\n * @author Vladimir Vershinin\n */\nimport RotateFeatureInteraction from \"./interaction\"\n\n// for backward compatibility\nif (typeof window !== 'undefined' && window.ol) {\n  window.ol.interaction.RotateFeature = RotateFeatureInteraction\n}\n\nexport default RotateFeatureInteraction\n"],"names":["assert","condition","message","join","Error","identity","arg","includes","arr","value","indexOf","isArray","val","Object","prototype","toString","RotateFeatureEventType","RotateFeatureEvent","type","features","angle","anchor","propagationStopped_","type_","features_","angle_","anchor_","ua","navigator","userAgent","toLowerCase","MAC","WEBKIT","mouseActionButton","mapBrowserEvent","originalEvent","button","ctrlKey","ANCHOR_KEY","ARROW_KEY","ANGLE_PROP","ANCHOR_PROP","RotateFeatureInteraction","options","previousCursor_","undefined","anchorFeature_","arrowFeature_","lastCoordinate_","anchorMoving_","overlay_","VectorLayer","style","getDefaultStyle","VectorSource","Collection","condition_","always","allowAnchorMovement","setAnchor","getFeaturesCentroid","setAngle","on","onFeatureAdd_","onFeatureRemove_","onAngleChange_","onAnchorChange_","createOrUpdateAnchorFeature_","createOrUpdateArrowFeature_","map","setMap","active","isNaN","parseFloat","set","get","length","getAngle","getAnchor","getGeometry","setCoordinates","Feature","Point","getSource","addFeature","resetAngle_","resetAnchor_","resetAngleAndAnchor_","getLength","clear","oldValue","forEach","feature","rotate","dispatchEvent","START","ROTATING","END","getMap","setActive","getActive","PointerInteraction","handleDownEvent","evt","mouseOnly","foundFeature","forEachFeatureAtPixel","pixel","getArray","coordinate","dispatchRotateStartEvent_","handleUpEvent","dispatchRotateEndEvent_","handleDragEvent","anchorCoordinate","getCoordinates","lastVector","newVector","Math","atan2","dispatchRotatingEvent_","handleMoveEvent","elem","getTargetElement","setCursor","cursor","vendor","white","blue","transparent","width","styles","Style","RegularShape","Fill","Stroke","Infinity","Text","resolution","getImage","setRotation","coordinates","geom","Polygon","setGeometry","getText","setText","round","PI","getFeaturesExtent","GeometryCollection","getExtent","getExtentCenter","window","ol","interaction","RotateFeature"],"mappings":"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"}